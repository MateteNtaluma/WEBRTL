<!DOCTYPE html>
<html>
<head>
  <title>Meu Mapa</title>
  <style>
    #map {
      height: 400px;
      width: 100%;
    }
  </style>
</head>
<body>
  <input type="text" id="search-input" placeholder="Digite um local">
  <div id="map"></div>

  <script src="https://www.openlayers.org/api/OpenLayers.js"></script>
  <script>
    function initMap() {
      // Inicialize o mapa
      var map = new OpenLayers.Map("map");
      map.addLayer(new OpenLayers.Layer.OSM());

      // Defina a exibição inicial do mapa
      var lonLat = new OpenLayers.LonLat(-46.633308, -23.550520).transform(
        new OpenLayers.Projection("EPSG:4326"),
        map.getProjectionObject()
      );
      map.setCenter(lonLat, 12);

      // Adicione a funcionalidade de pesquisa de lugares
      var searchInput = document.getElementById('search-input');
      searchInput.addEventListener('keypress', function (e) {
        if (e.key === 'Enter') {
          searchPlace();
        }
      });

      function searchPlace() {
        var query = searchInput.value;
        if (query.trim() !== '') {
          var request = OpenLayers.Request.GET({
            url: 'https://nominatim.openstreetmap.org/search?format=json&q=' + encodeURIComponent(query),
            callback: function (response) {
              var data = JSON.parse(response.responseText);
              if (data && data.length > 0) {
                var result = data[0];
                var lon = parseFloat(result.lon);
                var lat = parseFloat(result.lat);
                var point = new OpenLayers.LonLat(lon, lat).transform(
                  new OpenLayers.Projection("EPSG:4326"),
                  map.getProjectionObject()
                );
                map.setCenter(point, 15);
                addMarker(lon, lat);
              }
            }
          });
        }
      }

      // Adicione a funcionalidade de marcação de pontos
      function addMarker(lon, lat) {
        var markers = new OpenLayers.Layer.Markers("Markers");
        map.addLayer(markers);
        var marker = new OpenLayers.Marker(
          new OpenLayers.LonLat(lon, lat).transform(
            new OpenLayers.Projection("EPSG:4326"),
            map.getProjectionObject()
          )
        );
        markers.addMarker(marker);
      }
    }
  </script>
  <script>
    initMap();
  </script>
</body>
</html>
